<!DOCTYPE html>
<html>
<head>
  <title>User Details</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.0.1/css/bootstrap.min.css">
</head>
<body>
  <h2>User Details</h2>
  <table class="table caption-top">
    <caption>Number Of Users: <%= personals.length %></caption>
    <thead>
      <tr>
        <th>First Name</th>
        <th>Middle Name</th>
        <th>Last Name</th>
        <th>Gender</th>
        <th>Address</th>
        <th>Region</th>
        <th>City</th>
        <th>Civil Status</th>
        <th>Zipcode</th>
        <th>Hobby</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="userTableBody">
      <% personals.forEach((personal) => { %>
        <tr>
          <td><%= personal.fname %></td>
          <td><%= personal.mname %></td>
          <td><%= personal.lname %></td>
          <td><%= personal.gender %></td>
          <td><%= personal.address %></td>
          <td><%= personal.region %></td>
          <td><%= personal.city %></td>
          <td><%= personal.civilstatus %></td>
          <td><%= personal.zipcode %></td>
          <td><%= personal.hobby %></td>
          <td>
            <a href="#" class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#editModal<%= personal._id %>">Edit</a>
            
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>

  <% personals.forEach((personal) => { %>
    <div class="modal fade" id="editModal<%= personal._id %>" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editModalLabel">Edit User</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form action="/personal/update/<%= personal._id %>" method="POST">
              <div class="mb-3">
                <label for="editFname" class="form-label">First Name:</label>
                <input type="text" id="editFname" name="fname" class="form-control" value="<%= personal.fname %>" required>
              </div>
              <div class="mb-3">
                <label for="editmname" class="form-label">Middle Name:</label>
                <input type="text" id="editmname" name="mname" class="form-control" value="<%= personal.mname %>" required>
              </div>
              <div class="mb-3">
                <label for="editlname" class="form-label">Last Name:</label>
                <input type="text" id="editlname" name="lname" class="form-control" value="<%= personal.lname %>" required>
              </div>
              <div class="mb-3">
                <label for="editgender" class="form-label">Gender:</label>
                <input type="text" id="editgender" name="gender" class="form-control" value="<%= personal.gender %>" required>
              </div>
              <div class="mb-3">
                <label for="editaddress" class="form-label">Address:</label>
                <input type="text" id="editaddress" name="address" class="form-control" value="<%= personal.address %>" required>
              </div>
              <div class="mb-3">
                <label for="editregion" class="form-label">Region:</label>
                <input type="text" id="editregion" name="region" class="form-control" value="<%= personal.region %>" required>
              </div>
              <div class="mb-3">
                <label for="editcity" class="form-label">City:</label>
                <input type="text" id="editcity" name="city" class="form-control" value="<%= personal.city %>" required>
              </div>
              <div class="mb-3">
                <label for="editcivilstatus" class="form-label">Civil Status:</label>
                <input type="text" id="editcivilstatus" name="civilstatus" class="form-control" value="<%= personal.civilstatus %>" required>
              </div>
              <div class="mb-3">
                <label for="editzipcode" class="form-label">Zipcode:</label>
                <input type="text" id="editzipcode" name="zipcode" class="form-control" value="<%= personal.zipcode %>" required>
              </div>
              <div class="mb-3">
                <label for="edithobby" class="form-label">Hobby:</label>
                <input type="text" id="edithobby" name="hobby" class="form-control" value="<%= personal.hobby %>" required>
              </div>
              <!-- Repeat the above div structure for other fields -->
      
              <button type="submit" class="btn btn-primary">Save Changes</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  <% }) %>

  <script>
    // Retrieve the HTML elements
    const searchLastNameInput = document.getElementById('searchLastName');
    const userTableBody = document.getElementById('userTableBody');
  
    // Event listener for the input event on the search input field
    searchLastNameInput.addEventListener('input', () => {
      const searchTerm = searchLastNameInput.value.trim().toLowerCase();
  
      // Loop through each row and show/hide based on search term
      Array.from(userTableBody.getElementsByTagName('tr')).forEach((row) => {
        const lastName = row.getElementsByTagName('td')[2].innerText.toLowerCase();
        row.style.display = lastName.includes(searchTerm) ? 'table-row' : 'none';
      });
    });
  </script>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.0.1/js/bootstrap.bundle.min.js"></script>
</body>
</html>
